<!DOCTYPE html>
<html>
<!-- http://bl.ocks.org/erikvullings/51cc5332439939f1f292 -->
<head>
<meta charset="utf-8">
<title>Non-NSL-related Offenses</title>
<script src="https://d3js.org/d3.v3.min.js"></script>
<style>

/*
.chart rect {
  fill: steelblue;
}
*/

#wrapper
{
width:100%;
max-width: 300px;
margin:0 auto;
overflow:hidden;
}
#header
{
overflow:hidden;
max-width: 95%;
/* margin-bottom:5px; */
text-align:center;
vertical-align: text-top;
font-size: 14px;
}
#graphic
{
/* overflow:hidden; */
/* max-width: 90%;
margin-bottom:5px; */
/* text-align:center;
vertical-align: text-top; */
}

.chart .legend {
  fill: black;
  font: 14px sans-serif;
  text-anchor: start;
  font-size: 14px;
}

.chart text {
  /* fill: black; */
  font: 12px sans-serif;
  text-anchor: start;
}

.chart .label {
  fill: black;
  font: 13px sans-serif;
  text-anchor: end;
}

.bar:hover {
  fill: brown;
}

.axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}


</style>
</head>

<body>

	<div id="wrapper">
	<div id="header"><h1>Non-NSL-related Offenses, by Arrest and Charge</h1></div>
    <div id="graphic"></div>
</div>

<svg class="chart"></svg>
<script>



var data = {
  labels: [
		'Conspiracy to publish seditious materials', 'Conspiracy with intent to injure', 'Dangerous driving', 'Defraud', 'Funding or assisting criminals', 'Import without license', 'Money laundering', 'Firearms without license', 'Possession of offensive weapons', 'Sedition', 'Unlawful assembly'
  ],
  series: [
    {
      label: 'Arrests',
      values: [0, 2, 1, 7, 13, 2, 8, 2, 2, 2, 4]
    },
    {
      label: 'Charges',
      values: [1, 1, 0, 3, 2, 1, 1, 1, 1, 2, 0]
    },
]
};



var chartWidth       = 200,
    barHeight        = 20,
    groupHeight      = barHeight * data.series.length,
    gapBetweenGroups = 10,
    spaceForLabels   = 200,
    spaceForLegend   = 150;

// Zip the series data together (first values, second values, etc.)
var zippedData = [];
for (var i=0; i<data.labels.length; i++) {
  for (var j=0; j<data.series.length; j++) {
    zippedData.push(data.series[j].values[i]);
  }
}

// Color scale
//var color = d3.scale.category20();
var color = d3.scale.ordinal() //https://stackoverflow.com/a/21208204/7841877
.range(['#66c2a5', '#fc8d62']);
var chartHeight = barHeight * zippedData.length + gapBetweenGroups * data.labels.length;

var x = d3.scale.linear()
    // .domain([0, d3.max(zippedData)])
    // .range([0, chartWidth]);
		/////////////////////////////////////////////////
		////////////////////////////////////////////////
		//////////////// DO THIS IN PYTHON ////////////////
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// YOU WILL CHANGE THIS IN THE CHARTS SUCH THAT IT FEEDS IN THE MAX AMT FROM EITHER ONE SO IT'S ON THE SAME SCALE
		.domain([0, 55])
		.range([0, chartWidth]);

var y = d3.scale.linear()
    .range([chartHeight + gapBetweenGroups, 0]);

var yAxis = d3.svg.axis()
    .scale(y)
    .tickFormat('')
    .tickSize(0)
    .orient("left");


// Specify the chart area and dimensions
var chart = d3.select(".chart")
    .attr("width", spaceForLabels + chartWidth + spaceForLegend)
    .attr("height", chartHeight);

// Create bars
var bar = chart.selectAll("g")
    .data(zippedData)
    .enter().append("g")
    .attr("transform", function(d, i) {
      return "translate(" + spaceForLabels + "," + (i * barHeight + gapBetweenGroups * (0.5 + Math.floor(i/data.series.length))) + ")";
    });

// Create rectangles of the correct width
bar.append("rect")
    .attr("fill", function(d,i) { return color(i % data.series.length); })
    .attr("class", "bar")
    .attr("width", x)
    .attr("height", barHeight - 1);

// Add text label in bar
bar.append("text")
	// .attr("x", function(d) { return x(d) - 3; })
    .attr("x", function(d) { return x(d) + 5; })
    .attr("y", barHeight / 2)
		.attr("fill", function(d,i) { return color(i % data.series.length); }) // remove this line to have it default to black; you can also change to a single color in CSS
    .attr("dy", ".35em")
    .text(function(d) { return d; });

// Draw labels
bar.append("text")
    .attr("class", "label")
    .attr("x", function(d) { return - 7; })
    .attr("y", groupHeight / 2)
    .attr("dy", ".35em")
    .text(function(d,i) {
      if (i % data.series.length === 0)
        return data.labels[Math.floor(i/data.series.length)];
      else
        return ""});

chart.append("g")
      .attr("class", "y axis")
      .attr("transform", "translate(" + spaceForLabels + ", " + -gapBetweenGroups/2 + ")")
      .call(yAxis);

// Draw legend
var legendRectSize = 18,
    legendSpacing  = 4;

var legend = chart.selectAll('.legend')
    .data(data.series)
    .enter()
    .append('g')
    .attr('transform', function (d, i) {
        var height = legendRectSize + legendSpacing;
        var offset = -gapBetweenGroups/2;
        var horz = spaceForLabels + chartWidth + 0 - legendRectSize;
        var vert = i * height - offset;
        return 'translate(' + horz + ',' + vert + ')';
    });

legend.append('rect')
    .attr('width', legendRectSize)
    .attr('height', legendRectSize)
    .style('fill', function (d, i) { return color(i); })
    .style('stroke', function (d, i) { return color(i); });

legend.append('text')
    .attr('class', 'legend')
    .attr('x', legendRectSize + legendSpacing)
    .attr('y', legendRectSize - legendSpacing)
    .text(function (d) { return d.label; });

</script>
</body>
