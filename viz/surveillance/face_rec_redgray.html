<html>
<head>
  <title>Facial Recognition Cameras in Xiqiao Town, Nanhai District, Foshan City, Guangdong Province</title>
  <link rel="stylesheet" href="https://d19vzq90twjlae.cloudfront.net/leaflet-0.7.3/leaflet.css" />
  <script src="https://d19vzq90twjlae.cloudfront.net/leaflet-0.7.3/leaflet.js"></script>
  <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
  <style>

/* to get it so you don't lose the buttons upon zooming https://stackoverflow.com/questions/28820335/leaflet-clicking-zoom-control-removes-paging-top */
	body {
    margin: 0;
    height: calc(100% - 55px); /* minus navbar incl. border */
	}
		#wrapper{
			margin-right: auto; /* 1 */
  		margin-left:  auto; /* 1 */
  		max-width: 960px; 2 */
  		padding-right: 10px; /* 3 */
  		padding-left:  10px; /* 3 */
			padding-bottom:  10px;
			padding-top: 20px;
		}

    #map{
			height: 100%;
			width: 80%;
			padding-top:  20px;
			float:right;
			padding-right:10px;
		}

		#buttons{
			padding-top:  0px;
			float:left;
		}

		#points{
			padding-top:  20px;
			float:left;
			text-align:center;
		}

		button {
        width: 140px;
				margin-bottom: 5px;
				background-color: white;
  			color: black;
				font-size: 16px;
				border-radius: 2px;
				transition-duration: 0.4s;
				display: block;
    }

		.all {}
		.all:hover {background-color: #FF0000; color: white; }

		.points {
		/* max-width: 1200px; */
		/* margin: 120px 0px;
		padding: 10px 10px 10px 10px; */
		font: 14px sans-serif;
		/* background-repeat: no-repeat;
		background-position: 10px center; */
		color: #000000;
		background-color: #FFFFFF;
/* https://stackoverflow.com/questions/32511634/move-a-div-above-and-to-the-right-of-another-div */
		}

		.leaflet-marker-icon{
			opacity: 0.6;
		}


		/* .leaflet-marker-icon,
		.leaflet-marker-shadow {
			-webkit-animation: fadein 1.5s;
			-moz-animation: fadein 1.5s;
			-ms-animation: fadein 1.5s;
			-o-animation: fadein 1.5s;
			animation: fadein 1.5s;
			animation-fill-mode: both;
		} */

		/* @keyframes fadein {
				0%   {opacity: 0; }
				7%   {opacity: .05; }
				14%   {opacity: .1; }
				21%	 {opacity: .15; }
				28%   {opacity: .2; }
				35%   {opacity: .25; }
				42%	 {opacity: .3; }
				49%   {opacity: .35; }
				56%   {opacity: .4; }
				63%	 {opacity: .45; }
				70%   {opacity: .5; }
				77%   {opacity: .55; }
				84%   {opacity: .6; }
				91%   {opacity: .65; }
				100%   {opacity: .7; }} */


		/* Firefox < 16 */
		/* @-moz-keyframes fadein {
			0%   {opacity: 0; }
			7%   {opacity: .05; }
			14%   {opacity: .1; }
			21%	 {opacity: .15; }
			28%   {opacity: .2; }
			35%   {opacity: .25; }
			42%	 {opacity: .3; }
			49%   {opacity: .35; }
			56%   {opacity: .4; }
			63%	 {opacity: .45; }
			70%   {opacity: .5; }
			77%   {opacity: .55; }
			84%   {opacity: .6; }
			91%   {opacity: .65; }
			100%   {opacity: .7; }
		} */
		/* Safari, Chrome and Opera > 12.1 */
		/* @-webkit-keyframes fadein {
			0%   {opacity: 0; }
			7%   {opacity: .05; }
			14%   {opacity: .1; }
			21%	 {opacity: .15; }
			28%   {opacity: .2; }
			35%   {opacity: .25; }
			42%	 {opacity: .3; }
			49%   {opacity: .35; }
			56%   {opacity: .4; }
			63%	 {opacity: .45; }
			70%   {opacity: .5; }
			77%   {opacity: .55; }
			84%   {opacity: .6; }
			91%   {opacity: .65; }
			100%   {opacity: .7; }
		} */
		/* Internet Explorer */
		/* @-ms-keyframes fadein {
			0%   {opacity: 0; }
			7%   {opacity: .05; }
			14%   {opacity: .1; }
			21%	 {opacity: .15; }
			28%   {opacity: .2; }
			35%   {opacity: .25; }
			42%	 {opacity: .3; }
			49%   {opacity: .35; }
			56%   {opacity: .4; }
			63%	 {opacity: .45; }
			70%   {opacity: .5; }
			77%   {opacity: .55; }
			84%   {opacity: .6; }
			91%   {opacity: .65; }
			100%   {opacity: .7; }
		} */
		/* Opera < 12.1 */
		/* @-o-keyframes fadein {
			0%   {opacity: 0; }
			7%   {opacity: .05; }
			14%   {opacity: .1; }
			21%	 {opacity: .15; }
			28%   {opacity: .2; }
			35%   {opacity: .25; }
			42%	 {opacity: .3; }
			49%   {opacity: .35; }
			56%   {opacity: .4; }
			63%	 {opacity: .45; }
			70%   {opacity: .5; }
			77%   {opacity: .55; }
			84%   {opacity: .6; }
			91%   {opacity: .65; }
			100%   {opacity: .7; }
		} */



 /* TO DO:
 - FIGURE OUT ICON AND POPUP ANCHORS
 */

  </style>
</head>
<body>
	<div id="wrapper">
	<div id="buttons" class="btn-group">
			<button id="all" class="all">All</button>
			<button id="housing" class="all">Housing</button>
			<button id="food" class="all">Food</button>
			<button id="health" class="all">Health</button>
			<button id="clothing" class="all">Clothing</button>
			<button id="transport" class="all">Transportation</button>
			<button id="entertain" class="all">Entertainment</button>
			<button id="arts" class="all">Arts, Education, and Culture</button>
			<button id="travel" class="all">Travel</button>
			<button id="finance" class="all">Finance</button>
			<button id="other" class="all">Other</button>
	</div>

  <div id="map"></div>
	<div id="points" class="points"></div>
</div>
  <script>
// http://bl.ocks.org/awoodruff/2488ee1fdf0cf063904e
  // initialize the map
  var map = L.map('map').setView([22.926161653963995, 112.94053389709286], 12);

	var CameraIcon = L.Icon.extend({
		options: {
		iconSize: [38,35],
		//shadowUrl: 'shadow.png',
		//shadowSize:   [60, 30],
		iconAnchor:   [19, 17],
		//shadowAnchor: [22, 94],
		popupAnchor:  [0, -10]
		}
	});


	var Icon_red = new CameraIcon({iconUrl: 'red_filled_camera.png'}),
	Icon_gray = new CameraIcon({iconUrl: 'gray_gradient1_camera.png'});

  // load a tile layer
  L.tileLayer('https://stamen-tiles-{s}.a.ssl.fastly.net/toner-lite/{z}/{x}/{y}.png',
    {
      attribution: 'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &mdash; Camera icon by Mister Pixel from <a href="https://thenounproject.com/">The Noun Project</a>',
      maxZoom: 20,
      minZoom: 3
    }).addTo(map);


// yay code for button filtering from here: http://bl.ocks.org/zross/47760925fcb1643b4225
var stuff = $.getJSON("facerec_cameras_20200514.geojson");

stuff.then(function(data) {

    var all_cameras = L.geoJson(data);

    var housing = L.geoJson(data, {
        filter: function(feature, layer) {
            return feature.properties.location_category === "Housing";
        },
        pointToLayer: function(feature, latlng) {
            return L.marker(latlng, {
                icon: Icon_gray
            }).bindPopup(feature.properties.location_type + "<br/>" + feature.properties.location_name);
						// .on('mouseover', function() {
            //     this.bindPopup(feature.properties.location_type).openPopup();
            // });
        }
    });
		var housing_red = L.geoJson(data, {
				filter: function(feature, layer) {
						return feature.properties.location_category === "Housing";
				},
				pointToLayer: function(feature, latlng) {
						return L.marker(latlng, {
								icon: Icon_red
						}).bindPopup(feature.properties.location_type + "<br/>" + feature.properties.location_name);
				}
		});

		var food = L.geoJson(data, {
        filter: function(feature, layer) {
            return feature.properties.location_category === "Food";
        },
        pointToLayer: function(feature, latlng) {
            return L.marker(latlng, {
                icon: Icon_gray
            }).bindPopup(feature.properties.location_type + "<br/>" + feature.properties.location_name);
        }
    });
		var food_red = L.geoJson(data, {
				filter: function(feature, layer) {
						return feature.properties.location_category === "Food";
				},
				pointToLayer: function(feature, latlng) {
						return L.marker(latlng, {
								icon: Icon_red
						}).bindPopup(feature.properties.location_type + "<br/>" + feature.properties.location_name);
				}
		});

		var health = L.geoJson(data, {
				filter: function(feature, layer) {
						return feature.properties.location_category === "Healthcare";
				},
				pointToLayer: function(feature, latlng) {
						return L.marker(latlng, {
								icon: Icon_gray
						}).bindPopup(feature.properties.location_type + "<br/>" + feature.properties.location_name);
				}
		});
		var health_red = L.geoJson(data, {
				filter: function(feature, layer) {
						return feature.properties.location_category === "Healthcare";
				},
				pointToLayer: function(feature, latlng) {
						return L.marker(latlng, {
								icon:Icon_red
						}).bindPopup(feature.properties.location_type + "<br/>" + feature.properties.location_name);
				}
		});



		var clothing = L.geoJson(data, {
        filter: function(feature, layer) {
            return feature.properties.location_category === "Clothing";
        },
        pointToLayer: function(feature, latlng) {
            return L.marker(latlng, {
                icon: Icon_gray
            }).bindPopup(feature.properties.location_type + "<br/>" + feature.properties.location_name);
        }
    });
		var clothing_red = L.geoJson(data, {
				filter: function(feature, layer) {
						return feature.properties.location_category === "Clothing";
				},
				pointToLayer: function(feature, latlng) {
						return L.marker(latlng, {
								icon:Icon_red
						}).bindPopup(feature.properties.location_type + "<br/>" + feature.properties.location_name);
				}
		});


		var transport = L.geoJson(data, {
        filter: function(feature, layer) {
            return feature.properties.location_category === "Transportation";
        },
        pointToLayer: function(feature, latlng) {
            return L.marker(latlng, {
                icon: Icon_gray
            }).bindPopup(feature.properties.location_type + "<br/>" + feature.properties.location_name);
        }
    });
		var transport_red = L.geoJson(data, {
				filter: function(feature, layer) {
						return feature.properties.location_category === "Transportation";
				},
				pointToLayer: function(feature, latlng) {
						return L.marker(latlng, {
								icon: Icon_red
						}).bindPopup(feature.properties.location_type + "<br/>" + feature.properties.location_name);
				}
		});


		var entertain = L.geoJson(data, {
        filter: function(feature, layer) {
            return feature.properties.location_category === "Entertainment";
        },
        pointToLayer: function(feature, latlng) {
            return L.marker(latlng, {
                icon: Icon_gray
            }).bindPopup(feature.properties.location_type + "<br/>" + feature.properties.location_name);
        }
    });
		var entertain_red = L.geoJson(data, {
				filter: function(feature, layer) {
						return feature.properties.location_category === "Entertainment";
				},
				pointToLayer: function(feature, latlng) {
						return L.marker(latlng, {
								icon: Icon_red
						}).bindPopup(feature.properties.location_type + "<br/>" + feature.properties.location_name);
				}
		});


		var arts = L.geoJson(data, {
        filter: function(feature, layer) {
            return feature.properties.location_category === "Arts, Education, and Culture";
        },
        pointToLayer: function(feature, latlng) {
            return L.marker(latlng, {
                icon: Icon_gray
            }).bindPopup(feature.properties.location_type + "<br/>" + feature.properties.location_name);
        }
    });
		var arts_red = L.geoJson(data, {
				filter: function(feature, layer) {
						return feature.properties.location_category === "Arts, Education, and Culture";
				},
				pointToLayer: function(feature, latlng) {
						return L.marker(latlng, {
								icon: Icon_red
						}).bindPopup(feature.properties.location_type + "<br/>" + feature.properties.location_name);
				}
		});


		var travel = L.geoJson(data, {
        filter: function(feature, layer) {
            return feature.properties.location_category === "Travel";
        },
        pointToLayer: function(feature, latlng) {
            return L.marker(latlng, {
                icon: Icon_gray
            }).bindPopup(feature.properties.location_type + "<br/>" + feature.properties.location_name);
        }
    });
		var travel_red = L.geoJson(data, {
				filter: function(feature, layer) {
						return feature.properties.location_category === "Travel";
				},
				pointToLayer: function(feature, latlng) {
						return L.marker(latlng, {
								icon: Icon_red
						}).bindPopup(feature.properties.location_type + "<br/>" + feature.properties.location_name);
				}
		});


		var finance = L.geoJson(data, {
        filter: function(feature, layer) {
            return feature.properties.location_category === "Finance";
        },
        pointToLayer: function(feature, latlng) {
            return L.marker(latlng, {
                icon: Icon_gray
            }).bindPopup(feature.properties.location_type + "<br/>" + feature.properties.location_name);
        }
    });
		var finance_red = L.geoJson(data, {
				filter: function(feature, layer) {
						return feature.properties.location_category === "Finance";
				},
				pointToLayer: function(feature, latlng) {
						return L.marker(latlng, {
								icon: Icon_red
						}).bindPopup(feature.properties.location_type + "<br/>" + feature.properties.location_name);
				}
		});


		var other = L.geoJson(data, {
				filter: function(feature, layer) {
						return feature.properties.location_category === "Other/Unknown";
				},
				pointToLayer: function(feature, latlng) {
					return L.marker(latlng, {
							icon: Icon_gray
					}).bindPopup(feature.properties.location_type + "<br/>" + feature.properties.location_name);
				}
		});
		var other_red = L.geoJson(data, {
				filter: function(feature, layer) {
						return feature.properties.location_category === "Other/Unknown";
				},
				pointToLayer: function(feature, latlng) {
					return L.marker(latlng, {
							icon: Icon_red
					}).bindPopup(feature.properties.location_type + "<br/>" + feature.properties.location_name);
				}
		});




		var allPoints = all_cameras.getLayers().length;
		var housingPoints = housing.getLayers().length;
		var foodPoints = food.getLayers().length;
		var healthPoints = health.getLayers().length;
		var clothingPoints = clothing.getLayers().length;
		var transportPoints = transport.getLayers().length;
		var entertainPoints = entertain.getLayers().length;
		var artsPoints = arts.getLayers().length;
		var travelPoints = travel.getLayers().length;
		var financePoints = finance.getLayers().length;
		var otherPoints = other.getLayers().length;




    housing.addTo(map)
		food.addTo(map)
		health.addTo(map)
		clothing.addTo(map)
		transport.addTo(map)
		entertain.addTo(map)
		arts.addTo(map)
		travel.addTo(map)
		finance.addTo(map)
    other.addTo(map)
		$("#points").html("Number of Cameras: " + "<br>" + allPoints);



    $("#housing").click(function() {
			map.addLayer(housing_red)
			map.removeLayer(housing)
			map.removeLayer(food)
			map.removeLayer(health)
			map.removeLayer(clothing)
			map.removeLayer(transport)
			map.removeLayer(entertain)
			map.removeLayer(arts)
			map.removeLayer(travel)
			map.removeLayer(finance)
			map.removeLayer(other)
			map.removeLayer(food_red)
			map.removeLayer(health_red)
			map.removeLayer(clothing_red)
			map.removeLayer(transport_red)
			map.removeLayer(entertain_red)
			map.removeLayer(arts_red)
			map.removeLayer(travel_red)
			map.removeLayer(finance_red)
			map.removeLayer(other_red)
			$("#points").html("Number of Cameras: " + "<br>" + housingPoints)
    });

		$("#food").click(function() {
			map.addLayer(food_red)
			map.removeLayer(housing)
			map.removeLayer(food)
			map.removeLayer(other)
			map.removeLayer(health)
			map.removeLayer(clothing)
			map.removeLayer(transport)
			map.removeLayer(entertain)
			map.removeLayer(arts)
			map.removeLayer(travel)
			map.removeLayer(finance)
			map.removeLayer(housing_red)
			map.removeLayer(health_red)
			map.removeLayer(clothing_red)
			map.removeLayer(transport_red)
			map.removeLayer(entertain_red)
			map.removeLayer(arts_red)
			map.removeLayer(travel_red)
			map.removeLayer(finance_red)
			map.removeLayer(other_red)
			$("#points").html("Number of Cameras: " + "<br>" + foodPoints)
		});

		$("#health").click(function() {
			map.addLayer(health_red)
			map.removeLayer(housing)
			map.removeLayer(food)
			map.removeLayer(health)
			map.removeLayer(clothing)
			map.removeLayer(transport)
			map.removeLayer(entertain)
			map.removeLayer(arts)
			map.removeLayer(travel)
			map.removeLayer(finance)
			map.removeLayer(other)
			map.removeLayer(food_red)
			map.removeLayer(housing_red)
			map.removeLayer(clothing_red)
			map.removeLayer(transport_red)
			map.removeLayer(entertain_red)
			map.removeLayer(arts_red)
			map.removeLayer(travel_red)
			map.removeLayer(finance_red)
			map.removeLayer(other_red)
			$("#points").html("Number of Cameras: " + "<br>" + healthPoints)
    });

		$("#clothing").click(function() {
			map.addLayer(clothing_red)
			map.removeLayer(housing)
			map.removeLayer(food)
			map.removeLayer(health)
			map.removeLayer(clothing)
			map.removeLayer(transport)
			map.removeLayer(entertain)
			map.removeLayer(arts)
			map.removeLayer(travel)
			map.removeLayer(finance)
			map.removeLayer(other)
			map.removeLayer(food_red)
			map.removeLayer(housing_red)
			map.removeLayer(health_red)
			map.removeLayer(transport_red)
			map.removeLayer(entertain_red)
			map.removeLayer(arts_red)
			map.removeLayer(travel_red)
			map.removeLayer(finance_red)
			map.removeLayer(other_red)
			$("#points").html("Number of Cameras: " + "<br>" + clothingPoints)
    });

		$("#transport").click(function() {
			map.addLayer(transport_red)
			map.removeLayer(housing)
			map.removeLayer(food)
			map.removeLayer(health)
			map.removeLayer(clothing)
			map.removeLayer(transport)
			map.removeLayer(entertain)
			map.removeLayer(arts)
			map.removeLayer(travel)
			map.removeLayer(finance)
			map.removeLayer(other)
			map.removeLayer(food_red)
			map.removeLayer(housing_red)
			map.removeLayer(health_red)
			map.removeLayer(clothing_red)
			map.removeLayer(entertain_red)
			map.removeLayer(arts_red)
			map.removeLayer(travel_red)
			map.removeLayer(finance_red)
			map.removeLayer(other_red)
			$("#points").html("Number of Cameras: " + "<br>" + transportPoints)
    });

		$("#entertain").click(function() {
			map.addLayer(entertain_red)
			map.removeLayer(housing)
			map.removeLayer(food)
			map.removeLayer(health)
			map.removeLayer(clothing)
			map.removeLayer(transport)
			map.removeLayer(entertain)
			map.removeLayer(arts)
			map.removeLayer(travel)
			map.removeLayer(finance)
			map.removeLayer(other)
			map.removeLayer(food_red)
			map.removeLayer(housing_red)
			map.removeLayer(health_red)
			map.removeLayer(clothing_red)
			map.removeLayer(transport_red)
			map.removeLayer(arts_red)
			map.removeLayer(travel_red)
			map.removeLayer(finance_red)
			map.removeLayer(other_red)
			$("#points").html("Number of Cameras: " + "<br>" + entertainPoints)
    });

		$("#arts").click(function() {
			map.addLayer(arts_red)
			map.removeLayer(housing)
			map.removeLayer(food)
			map.removeLayer(health)
			map.removeLayer(clothing)
			map.removeLayer(transport)
			map.removeLayer(entertain)
			map.removeLayer(arts)
			map.removeLayer(travel)
			map.removeLayer(finance)
			map.removeLayer(other)
			map.removeLayer(food_red)
			map.removeLayer(housing_red)
			map.removeLayer(health_red)
			map.removeLayer(clothing_red)
			map.removeLayer(transport_red)
			map.removeLayer(entertain_red)
			map.removeLayer(travel_red)
			map.removeLayer(finance_red)
			map.removeLayer(other_red)
			$("#points").html("Number of Cameras: " + "<br>" + artsPoints)
    });

		$("#travel").click(function() {
			map.addLayer(travel_red)
			map.removeLayer(housing)
			map.removeLayer(food)
			map.removeLayer(health)
			map.removeLayer(clothing)
			map.removeLayer(transport)
			map.removeLayer(entertain)
			map.removeLayer(arts)
			map.removeLayer(travel)
			map.removeLayer(finance)
			map.removeLayer(other)
			map.removeLayer(food_red)
			map.removeLayer(housing_red)
			map.removeLayer(health_red)
			map.removeLayer(clothing_red)
			map.removeLayer(transport_red)
			map.removeLayer(entertain_red)
			map.removeLayer(arts_red)
			map.removeLayer(finance_red)
			map.removeLayer(other_red)
			$("#points").html("Number of Cameras: " + "<br>" + travelPoints)
    });

		$("#finance").click(function() {
			map.addLayer(finance_red)
			map.removeLayer(housing)
			map.removeLayer(food)
			map.removeLayer(other)
			map.removeLayer(health)
			map.removeLayer(clothing)
			map.removeLayer(transport)
			map.removeLayer(entertain)
			map.removeLayer(arts)
			map.removeLayer(travel)
			map.removeLayer(finance)
			map.removeLayer(housing_red)
			map.removeLayer(health_red)
			map.removeLayer(clothing_red)
			map.removeLayer(transport_red)
			map.removeLayer(entertain_red)
			map.removeLayer(arts_red)
			map.removeLayer(travel_red)
			map.removeLayer(food_red)
			map.removeLayer(other_red)
				$("#points").html("Number of Cameras: " + "<br>" + financePoints)
    });

		$("#other").click(function() {
				$("#points").html("Number of Cameras: " + "<br>" + otherPoints)
				map.addLayer(other_red)
				map.removeLayer(housing)
				map.removeLayer(food)
				map.removeLayer(health)
				map.removeLayer(clothing)
				map.removeLayer(transport)
				map.removeLayer(entertain)
				map.removeLayer(arts)
				map.removeLayer(travel)
				map.removeLayer(finance)
				map.removeLayer(housing_red)
				map.removeLayer(food_red)
				map.removeLayer(health_red)
				map.removeLayer(clothing_red)
				map.removeLayer(transport_red)
				map.removeLayer(entertain_red)
				map.removeLayer(arts_red)
				map.removeLayer(travel_red)
				map.removeLayer(finance_red)
				map.removeLayer(other)
				$("#points").html("Number of Cameras: " + "<br>" + otherPoints)
    });


    $("#all").click(function() {
			map.addLayer(housing)
			map.addLayer(food)
			map.addLayer(health)
			map.addLayer(clothing)
			map.addLayer(transport)
			map.addLayer(entertain)
			map.addLayer(arts)
			map.addLayer(travel)
			map.addLayer(finance)
			map.addLayer(other)
			map.removeLayer(housing_red)
			map.removeLayer(food_red)
			map.removeLayer(health_red)
			map.removeLayer(clothing_red)
			map.removeLayer(transport_red)
			map.removeLayer(entertain_red)
			map.removeLayer(arts_red)
			map.removeLayer(travel_red)
			map.removeLayer(finance_red)
			map.removeLayer(other_red)
			$("#points").html("Number of Cameras: " + "<br>" + allPoints)
    });
});

  </script>
</body>
</html>
