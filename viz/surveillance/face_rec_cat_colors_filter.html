<html>
<head>
  <title>A Leaflet map!</title>
  <link rel="stylesheet" href="https://d19vzq90twjlae.cloudfront.net/leaflet-0.7.3/leaflet.css" />
  <script src="https://d19vzq90twjlae.cloudfront.net/leaflet-0.7.3/leaflet.js"></script>
  <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
  <style>
    #map{ height: 100% }

		button {
        width: 100px;
				margin-bottom: 5px;
				background-color: white;
  			color: black;
				font-size: 16px;
				border-radius: 2px;
				transition-duration: 0.4s;
    }

		.all {border: 2px solid #6a0dad;}
		.all:hover {background-color: #6a0dad; color: white;}
		.housing {border: 2px solid #FF0000;}
		.housing:hover {background-color: #FF0000; color: white;}
		.food {border: 2px solid #4CAF50;}
		.food:hover {background-color: #4CAF50; color: white;}
		.other {border: 2px solid #555555; color: black;}
		.other:hover {background-color: #555555; color: white;}

  </style>
</head>
<body>
	<div class="btn-group">
			<button id="all" class="all">All</button>
			<button id="housing" class="housing">Housing</button>
			<button id="food" class="food">Food</button>
			<button id="other" class="other">Other</button>
	</div>
  <div id="map"></div>

  <script>
// http://bl.ocks.org/awoodruff/2488ee1fdf0cf063904e
  // initialize the map
  var map = L.map('map').setView([22.926161653963995, 112.94053389709286], 12);

	var CameraIcon = L.Icon.extend({
options: {
		iconSize: [38,34],
		//shadowUrl: 'shadow.png',
		//shadowSize:   [60, 30],
		iconAnchor:   [22, 94],
		//shadowAnchor: [22, 94],
		popupAnchor:  [-3, -76]
		}
	});


	var housingIcon = new CameraIcon({iconUrl: 'camera_red.png'}),
	foodIcon = new CameraIcon({iconUrl: 'camera_green.png', shadowUrl: 'shadow.png', shadowSize:[60, 30], shadowAnchor: [22, 94]}),
	healthIcon = new CameraIcon({iconUrl: 'camera_purple.png'}),
	clothingIcon = new CameraIcon({iconUrl: 'camera_gold.png'}),
	otherIcon = new CameraIcon({iconUrl: 'camera_black.png'});

  // load a tile layer
  L.tileLayer('https://stamen-tiles-{s}.a.ssl.fastly.net/toner-lite/{z}/{x}/{y}.png',
    {
      attribution: 'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
      maxZoom: 20,
      minZoom: 3
    }).addTo(map);


// yay code for button filtering from here: http://bl.ocks.org/zross/47760925fcb1643b4225
var stuff = $.getJSON("face_rec.geojson");

stuff.then(function(data) {
    var all_cameras = L.geoJson(data);
    var housing = L.geoJson(data, {
        filter: function(feature, layer) {
            return feature.properties.fake_category === "Housing";
        },
        pointToLayer: function(feature, latlng) {
            return L.marker(latlng, {
                icon: housingIcon
            }).on('mouseover', function() {
                this.bindPopup(feature.properties.fake_tooltip).openPopup();
            });
        }
    });
		var food = L.geoJson(data, {
        filter: function(feature, layer) {
            return feature.properties.fake_category === "Food";
        },
        pointToLayer: function(feature, latlng) {
            return L.marker(latlng, {
                icon: foodIcon
            }).on('mouseover', function() {
                this.bindPopup(feature.properties.fake_tooltip).openPopup();
            });
        }
    });
		var other = L.geoJson(data, {
				filter: function(feature, layer) {
						return feature.properties.fake_category != "Housing" & feature.properties.fake_category != "Food";
				},
				pointToLayer: function(feature, latlng) {
					return L.marker(latlng, {
							icon: otherIcon
					}).bindPopup(feature.properties.fake_tooltip);
				}
		});


    housing.addTo(map)
		food.addTo(map)
    other.addTo(map)
    // The JavaScript below is new
    $("#other").click(function() {
        map.addLayer(other)
        map.removeLayer(housing)
				map.removeLayer(food)
    });
    $("#housing").click(function() {
			map.addLayer(housing)
			map.removeLayer(other)
			map.removeLayer(food)
    });
		$("#food").click(function() {
			map.addLayer(food)
			map.removeLayer(housing)
			map.removeLayer(other)
		});
    $("#all").click(function() {
			map.addLayer(food)
			map.addLayer(housing)
			map.addLayer(other)
    });
});

/*
// THIS IS FROM THE OLDER VERSION
  // load GeoJSON from an external file
  $.getJSON("face_rec.geojson",function(data){

    L.geoJson(data,{
      pointToLayer: function(feature,latlng){
//https://gis.stackexchange.com/a/233518
				if (feature.properties.fake_category === "Housing") {
						return L.marker(latlng, {
								icon: housingIcon
						}).bindPopup(feature.properties.fake_tooltip);
				}
				else if (feature.properties.fake_category === "Food") {
						return L.marker(latlng, {
								icon: foodIcon
						}).bindPopup(feature.properties.fake_tooltip);
				} else {
						return L.marker(latlng, {
								icon: otherIcon
						}).bindPopup(feature.properties.fake_tooltip);
				}

      }
    }).addTo(map);
  });
*/


  </script>
</body>
</html>
